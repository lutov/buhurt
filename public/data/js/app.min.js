function show_entrance(){var t=$("#entrance_block");t.lightbox_me({closeSelector:".close",centered:!0})}function show_registration(){var t=$("#registration_block");t.lightbox_me({closeSelector:".close",centered:!0})}function set_wanted(t,e){var n=$("#want_"+e),o="btn-outline-success",s="btn-success";if(n.hasClass(o)){var i="/set_wanted/"+t+"/"+e;$.post(i,{},function(t){n.removeClass(o),n.addClass(s),showToast(t)})}}function unset_wanted(t,e){var n=$("#want_"+e),o="btn-outline-success",s="btn-success";if(n.hasClass(s)){var i="/unset_wanted/"+t+"/"+e;$.post(i,{},function(t){n.removeClass(s),n.addClass(o),showToast(t)})}}function set_unwanted(t,e){var n=$("#not_want_"+e),o="btn-outline-danger",s="btn-danger";if(n.hasClass(o)){var i="/set_unwanted/"+t+"/"+e;$.post(i,{},function(t){n.removeClass(o),n.addClass(s),showToast(t)})}}function unset_unwanted(t,e){var n=$("#not_want_"+e),o="btn-outline-danger",s="btn-danger";if(n.hasClass(s)){var i="/unset_unwanted/"+t+"/"+e;$.post(i,{},function(t){n.removeClass(s),n.addClass(o),showToast(t)})}}function add_to_list(t,e,n){var o="/lists/add_to_lists/";$.post(o,{id:e,section:t,list_id:n},function(t){})}function remove_from_list(t,e,n){var o="/lists/remove_from_lists/";$.post(o,{id:e,section:t,list_id:n},function(t){})}function toggle_list(t,e,n){var o=$(n);o.prop("checked")?add_to_list(t,e,o.val()):remove_from_list(t,e,o.val())}function add_list(t,e){var n="/lists/add_list/",o=$("#new_list").val();$.post(n,{name:o},function(n){lists(t,e)})}function remove_list(t,e,n){var o="/lists/remove_list/";$.post(o,{list_id:n},function(n){lists(t,e)})}function lists(t,e){var n="/lists/get_lists/";$.post(n,{},function(n){var o='<form method="POST">';jQuery.each(n.data,function(n,s){var i="onclick=\"toggle_list('"+t+"', "+e+', this)"';o+="<div>",o+='<input type="checkbox" name="list" id="list_'+s.id+'" value="'+s.id+'" '+i+">",o+="&nbsp;",o+='<label for="list_'+s.id+'">',o+=s.name,o+="</label>",o+="</div>",$.post("/lists/find_element",{id:e,section:t,list_id:s.id},function(t){t.id&&$("#list_"+s.id).prop("checked",!0)})}),o+="</form>",o+='<form method="POST">',o+="<div>",o+='<input type="text" name="new_list" id="new_list" placeholder="Новый список" class="form-control">',o+='<button class="btn btn-outline-primary" type="button" onclick="add_list(\''+t+"', '"+e+"')\">Создать</button>",o+="</div>",o+="</form>";var s={title:"Добавить в список",message:o,leave:!0};show_popup(s)})}function show_comment_form(){var t=$("#comment_form");t.show(600)}function comment_add(t,e){var n="",o=$("#comment").val();if(""!==o){var s=$("#comment_id"),i=s.val();""===i?(n="/comment/add",$.post(n,{comment:o,section:t,element:e},function(t){var e=$.parseJSON(t);$(".comments").prepend(e.comment_text),$("#comment_form").hide(600)})):(n="/comment/edit",$.post(n,{comment:o,section:t,element:e,id:i},function(t){var e=$.parseJSON(t);$("#comment_"+i).replaceWith(e.comment_text),$("#comment_form").hide(600)}))}}function comment_edit(t){var e=$("#comment_"+t+"_text"),n=$("#comment"),o=$("#comment_id"),s=e.html();s=s.replace(/<br>/g,""),o.val(t),n.val(s),show_comment_form()}function comment_delete(t){if(window.confirm("Удалить комментарий?")){var e="/comment/delete";$.post(e,{id:t},function(e){$("#comment_"+t).hide(600)})}}function show_section(t){location.href="/admin/add/"+t}function expand_genres(t,e){$("#"+e).show(600),$(t).removeClass("symlink")}function bind_genres(t,e){jQuery.each($("#"+t).children("li"),function(t,n){$(this).addClass("active_text"),$(this).click(function(){var t=$("#"+e);""===t.val()?t.val($(this).html()):t.val(t.val()+"; "+$(this).html())})})}function show_popup(t){var e=$("#modal_block"),n=$("#modal_title"),o=$("#modal_content"),s=t.message,i=3e3,a=t.title;n.html(a);var c="";if("achievement"===t.type){var l="";l+='<div class="modal_images">';for(var r in t.images)t.msg_img.hasOwnProperty(r)&&(l+='<img src="/data/img/achievements/'+t.images[r]+'.png" alt="" class="img-fluid">&nbsp;');l+="</div>",c+=l}c+='<div class="modal_text">'+s+"</div>",o.html(c),e.modal(),t.leave||e.on("shown.bs.modal",function(t){setTimeout(function(){e.modal("hide")},i)})}function showToast(t){var e=$("#toast_block"),n=$("#toast_title"),o=$("#toast_content"),s=t.title;n.html(s);var i=t.message;o.html(i),e.toast("show")}$(function(){"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/service-worker.js").then(function(t){},function(t){})}),function(t,e,n){(e[n]=e[n]||[]).push(function(){try{e.yaCounter25959328=new Ya.Metrika({id:25959328,clickmap:!0,trackLinks:!0,accurateTrackBounce:!0})}catch(t){}});var o=t.getElementsByTagName("script")[0],s=t.createElement("script"),i=function(){o.parentNode.insertBefore(s,o)};s.type="text/javascript",s.async=!0,s.src="https://mc.yandex.ru/metrika/watch.js","[object Opera]"==e.opera?t.addEventListener("DOMContentLoaded",i,!1):i()}(document,window,"yandex_metrika_callbacks"),function(t,e,n,o,s,i,a){t.GoogleAnalyticsObject=s,t[s]=t[s]||function(){(t[s].q=t[s].q||[]).push(arguments)},t[s].l=1*new Date,i=e.createElement(n),a=e.getElementsByTagName(n)[0],i.async=1,i.src=o,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-101861790-1","auto"),ga("send","pageview")});