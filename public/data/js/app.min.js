$(function(){"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/service-worker.js").then(function(){},function(){})}),$("#search").autocomplete({source:"/search/json",minLength:3,delay:500,select:function(a,b){$("#search").val(b.item.value),$("#search_form").submit()}});let a=$(".fast_rating");a&&a.rating({language:"ru",theme:"krajee-uni",size:"xs",emptyStar:"&#9734;",filledStar:"&#9733;",clearButton:"&#10006;",min:0,max:10,step:1,stars:"10",animate:!1,showCaption:!1,showClear:!1,clearCaption:"\u041D\u0435\u0442 \u043E\u0446\u0435\u043D\u043A\u0438",starCaptions:{1:"\u041E\u0447\u0435\u043D\u044C \u043F\u043B\u043E\u0445\u043E",2:"\u041F\u043B\u043E\u0445\u043E",3:"\u041F\u043E\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0435\u043D\u043D\u043E",4:"\u041D\u0438\u0436\u0435 \u0441\u0440\u0435\u0434\u043D\u0435\u0433\u043E",5:"\u0421\u0440\u0435\u0434\u043D\u0435",6:"\u0412\u044B\u0448\u0435 \u0441\u0440\u0435\u0434\u043D\u0435\u0433\u043E",7:"\u041D\u0435\u043F\u043B\u043E\u0445\u043E",8:"\u0425\u043E\u0440\u043E\u0448\u043E",9:"\u041E\u0442\u043B\u0438\u0447\u043D\u043E",10:"\u0412\u0435\u043B\u0438\u043A\u043E\u043B\u0435\u043F\u043D\u043E"},starCaptionClasses:function(a){return null===a?"badge badge-default":3>=a?"badge badge-danger":5>=a?"badge badge-warning":7>=a?"badge badge-primary":"badge badge-success"}});let b=window.location.href;if(0<b.indexOf("#")){var c=b.substring(b.indexOf("#")+1);$(".nav[role=\"tablist\"] a[href=\"#"+c+"\"]").tab("show")}$("a[role=\"tab\"]").on("click",function(){let a;const c=$(this).attr("href");a=b.split("#")[0]+c,history.replaceState(null,null,a)})});function set_wanted(a,b){var c=$("#want_"+b),d="btn-outline-success";if(c.hasClass(d)){$.post("/set_wanted/"+a+"/"+b,{},function(a){c.removeClass(d),c.addClass("btn-success"),showToast(a)})}}function unset_wanted(a,b){var c=$("#want_"+b),d="btn-success";if(c.hasClass(d)){$.post("/unset_wanted/"+a+"/"+b,{},function(a){c.removeClass(d),c.addClass("btn-outline-success"),showToast(a)})}}function set_unwanted(a,b){var c=$("#not_want_"+b),d="btn-outline-danger";if(c.hasClass(d)){$.post("/set_unwanted/"+a+"/"+b,{},function(a){c.removeClass(d),c.addClass("btn-danger"),showToast(a)})}}function unset_unwanted(a,b){var c=$("#not_want_"+b),d="btn-danger";if(c.hasClass(d)){$.post("/unset_unwanted/"+a+"/"+b,{},function(a){c.removeClass(d),c.addClass("btn-outline-danger"),showToast(a)})}}function show_comment_form(){var a=$("#comment_form");a.show(600)}function comment_add(a,b){var c="",d=$("#comment").val();if(""!==d){var e=$("#comment_id"),f=e.val();""===f?(c="/comment/add",$.post(c,{comment:d,section:a,element:b},function(a){var b=$.parseJSON(a);$(".comments").prepend(b.comment_text),$("#comment_form").hide(600)})):(c="/comment/edit",$.post(c,{comment:d,section:a,element:b,id:f},function(a){var b=$.parseJSON(a);$("#comment_"+f).replaceWith(b.comment_text),$("#comment_form").hide(600)}))}}function comment_edit(a){let b=$("#comment_"+a+"_text"),c=$("#comment"),d=$("#comment_id"),e=b.html(),f=$("<textarea />").html(e).text();f=f.replace(/<\/?[^>]+>/gi,""),d.val(a),c.val(f),show_comment_form()}function comment_delete(a){if(window.confirm("\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u043A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439?")){$.post("/comment/delete",{id:a},function(){$("#comment_"+a).hide(600)})}}function expand_genres(a,b){$("#"+b).show(600),$(a).removeClass("symlink")}function bind_genres(a,b){jQuery.each($("#"+a).children("li"),function(){$(this).addClass("active_text"),$(this).click(function(){var a=$("#"+b);""===a.val()?a.val($(this).html()):a.val(a.val()+"; "+$(this).html())})})}function show_popup(a){var b=$("#modal_block"),c=$("#modal_title"),d=$("#modal_content"),e=a.message,f=a.title;c.html(f);var g="";if("achievement"===a.type){var h="";for(var j in h+="<div class=\"modal_images\">",a.images)a.msg_img.hasOwnProperty(j)&&(h+="<img src=\"/data/img/achievements/"+a.images[j]+".png\" alt=\"\" class=\"img-fluid\">&nbsp;");h+="</div>",g+=h}g+="<div class=\"modal_text\">"+e+"</div>",d.html(g),b.modal(),a.leave||b.on("shown.bs.modal",function(){setTimeout(function(){b.modal("hide")},3e3)})}function showToast(a){var b=$("#toast_block"),c=$("#toast_title"),d=$("#toast_content"),e=a.title;c.html(e);var f=a.message;d.html(f),b.toast("show")}